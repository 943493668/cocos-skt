{"version":3,"sources":["assets/script/index/shop.js"],"names":["require","wxcur","basis","cc","Class","Component","properties","skin","Prefab","myfigure","dragonBones","ArmatureDisplay","figureWords","Label","freeUseBut","Node","figureFun","shopList","funBut1","funBut2","funBut3","onLoad","myfigureData","wearSkil","curSkin","setMyFigure","addShopFigure","i","figureList","length","node","instantiate","getComponent","init","figureListIndex","parent","confirmSwitchSkin","wearSkilData","curSkinData","use","skinData","myfigureIndex","index","_this","setrenwu","buySkin","data","gold","popup","setGold","hava","trialSkin","gotoGame","active","armatureName","imgName","playAnimation","height","string","figureWord","effect","type","update","dt"],"mappings":"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","sourceRoot":"/","sourcesContent":["const { wxcur } = require('weixin_ty');\nconst { basis } = require('basis');\n\nimport { index } from './index.js';\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        skin: cc.Prefab,\n        myfigure: dragonBones.ArmatureDisplay,\n        figureWords: cc.Label,\n        freeUseBut: cc.Node,\n        figureFun: cc.Label,\n        shopList: cc.Node,\n        funBut1: cc.Node,\n        funBut2: cc.Node,\n        funBut3: cc.Node,\n    },\n\n    onLoad() {\n        this.myfigureData = basis.myfigure;\n        this.wearSkil = null;\n        this.curSkin = null;\n        this.setMyFigure();\n        this.addShopFigure();\n    },\n    addShopFigure() {\n        for (let i = 0; i < basis.figureList.length; i++) {\n            const node = cc.instantiate(this.skin);\n            node.getComponent('skin').init(basis.figureList[i], this);\n            node.figureListIndex = i;\n            node.parent = this.shopList;\n        }\n    },\n    confirmSwitchSkin() {\n        const wearSkilData = basis.figureList[this.wearSkil.node.figureListIndex];\n        const curSkinData = basis.figureList[this.curSkin.node.figureListIndex];\n\n        wearSkilData.use = false;\n        curSkinData.use = true;\n        this.wearSkil.init(wearSkilData, this);\n        this.curSkin.init(curSkinData, this);\n\n        basis.myfigure = this.curSkin.skinData;\n        basis.myfigureIndex = this.curSkin.node.figureListIndex;\n\n        index._this.setrenwu();\n\n        this.wearSkil = this.curSkin;\n        this.curSkin = null;\n\n        this.setMyFigure()\n    },\n    buySkin() {\n        const data = basis.figureList[this.curSkin.node.figureListIndex];\n\n        if (basis.gold < data.gold) {\n            index._this.popup('', 'goldNotEnoughPopup');\n            return\n        }\n\n        basis.gold -= data.gold;\n        index._this.setGold();\n        data.hava = true;\n        this.curSkin.init(data, this);\n        this.setMyFigure()\n    },\n    trialSkin() {\n        basis.myfigure = this.curSkin.skinData;\n        index._this.gotoGame();\n    },\n    setMyFigure() {\n        this.funBut1.active = false;\n        this.funBut2.active = false;\n        this.funBut3.active = false;\n\n        this.myfigure.armatureName = this.myfigureData.imgName;\n        this.myfigure.playAnimation('行走');\n        this.myfigure.node.height = this.myfigureData.height;\n\n        \n\n        this.figureWords.string = this.myfigureData.figureWord;\n        this.figureFun.string = `角色移动速度+${this.myfigureData.effect * 100}%`;\n\n        if (this.myfigureData.hava) {\n            this.freeUseBut.active = false;\n            if (!this.myfigureData.use) {\n                this.funBut3.active = true;\n            }\n        } else {\n            this.freeUseBut.active = true;\n\n            if (this.myfigureData.type == 'gold') {\n                this.funBut2.active = true;\n            } else {\n                this.funBut1.active = true;\n            }\n        }\n    },\n    update(dt) { },\n});\n"]}