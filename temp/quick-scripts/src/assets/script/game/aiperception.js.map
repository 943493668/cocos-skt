{"version":3,"sources":["assets/script/game/aiperception.js"],"names":["require","basis","cc","Class","Component","properties","onLoad","parent","node","getComponent","CircleCollider","radius","aiPerception","initList","list","zhurenwuList","kerenwuList","tanweiList","jnengList","moenyList","onCollisionEnter","other","self","name","invincible","nameSplit","split","_id","nodeCom","zhanlingzhenode","zhanlziszai","myfollowerList","length","onCollisionExit"],"mappings":"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","sourceRoot":"/","sourcesContent":["const { basis } = require('basis');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n    },\n\n    onLoad() {\n        this.parent = this.node.parent;\n        this.node.getComponent(cc.CircleCollider).radius = basis.aiPerception;\n\n        this.initList();\n    },\n    initList() {\n        this.list = {\n            zhurenwuList: {},//主人物\n            kerenwuList: {},//客人物\n            tanweiList: {},//摊位\n            jnengList: {},//技能\n            moenyList: {},//钱\n        }\n        return this.list\n    },\n    onCollisionEnter: function (other, self) {\n        const node = other.node;\n\n\n        if (node.name == this.parent.name) return;\n\n        if (node.invincible > 0) return;\n\n        const nameSplit = node.name.split('-');\n\n        if (nameSplit[0] == '散') {\n            this.list.kerenwuList[node._id] = node;\n\n        } else if (nameSplit[0] == '摊位') {\n            const nodeCom = node.getComponent('booth');\n            if (this.list.zhurenwuList[nodeCom.zhanlingzhenode._id]) return;\n            if (nodeCom.zhanlziszai) {\n                delete this.list.tanweiList[node._id];\n                return\n            }\n            this.list.tanweiList[node._id] = node;\n        } else if (nameSplit[0] == '吞噬圈') {\n            if (node.parent.name == this.parent.name) return;\n            const nodeCom = node.parent.getComponent('renwu');\n            if (nodeCom.myfollowerList.length == 0) {\n                delete this.list.zhurenwuList[node._id];\n                return\n            };\n            this.list.zhurenwuList[node._id] = node.parent;\n        } else if (nameSplit[0] == '技能') {\n            this.list.jnengList[node._id] = node;\n        } else if (nameSplit[0] == '钞票') {\n            this.list.moenyList[node._id] = node;\n        }\n    },\n    onCollisionExit: function (other, self) {\n        const node = other.node;\n        if (node.name == this.parent.name) return;\n\n        if (node.invincible > 0 || this.parent.invincible > 0) return;\n\n        const nameSplit = node.name.split('-');\n        if (nameSplit[0] == '散') {\n\n            delete this.list.kerenwuList[node._id];\n\n        } else if (nameSplit[0] == '摊位') {\n            delete this.list.tanweiList[node._id];\n\n        } else if (nameSplit[0] == '吞噬圈') {\n            delete this.list.zhurenwuList[node._id];\n        } else if (nameSplit[0] == '技能') {\n            delete this.list.jnengList[node._id];\n\n        } else if (nameSplit[0] == '钞票') {\n            delete this.list.moenyList[node._id];\n        }\n    }\n});\n"]}