{"version":3,"sources":["assets/script/game/game.js"],"names":["require","wxcur","basis","game","cc","Class","Component","properties","dianchumb","Node","caozuodi","caozuoopan","renwu","camera","onLoad","_this","gameStart","zIndex","getComponent","manager","director","getCollisionManager","enabled","on","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd","imgarr","splice","findIndex","res","myfigure","imgName","aiRomImg","randomArr","aiNum","console","log","getCanvMoreHeight","arr","num","newArr","i","temp","Math","floor","random","length","push","start","bgm","music","openMusic","size","view","getFrameSize","height","width","e","death","yidongfig","getLocation","stopAllActions","opacity","y","x","delta","getDelta","angle","getAngle","hudu","PI","xiebian","pow","maxxiebian","sin","cos","runAction","fadeOut","ydshijiao","node","interact","gaoguang","yidong","yingcang","v2","convertToNodeSpaceAR","update","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["\nconst { wxcur } = require('weixin_ty');\nconst { basis } = require('basis');\n\nimport { followerlist } from './followerlist.js'\nimport { interact } from './interact.js'\nimport { music } from './../currency/music.js';\n\nconst game = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        dianchumb: cc.Node,\n        caozuodi: cc.Node,\n        caozuoopan: cc.Node,\n        renwu: cc.Node,\n        camera: cc.Node,\n    },\n\n    onLoad() {\n        game._this = this;\n\n        this.gameStart = true;\n\n        this.renwu.zIndex = 999999;\n        this.renwu = this.renwu.getComponent('renwu');\n\n\n        var manager = cc.director.getCollisionManager();\n        manager.enabled = true;\n        //manager.enabledDebugDraw = true;\n        //manager.enabledDrawBoundingBox = true;\n\n        this.dianchumb.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\n        this.dianchumb.on(cc.Node.EventType.TOUCH_MOVE, this.touchMove, this);\n        this.dianchumb.on(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\n\n        this.renwu.zIndex = 2;\n        const imgarr = ['001', '002', '003', '004', '005', '006', '007', '008', '009', '010', '011', '012']\n\n        imgarr.splice(imgarr.findIndex(res => res == basis.myfigure.imgName), 1);\n\n        this.aiRomImg = this.randomArr(imgarr, basis.aiNum);\n        console.log(this.aiRomImg)\n        this.getCanvMoreHeight();\n    },\n    randomArr(arr, num) {\n        let newArr = [];//创建一个新数组\n        for (let i = 0; i < num; i++) {\n            let temp = Math.floor(Math.random() * arr.length);//取随机下标\n            newArr.push(arr[temp]);//添加到新数组\n            arr.splice(temp, 1)//删除当前的数组元素,避免重复\n        }\n        return newArr;\n    },\n    start() {\n        this.bgm = music._this.openMusic('', 'bgm2', true);\n    },\n    getCanvMoreHeight() {\n        const size = cc.view.getFrameSize();\n        this.height = ((667 * size.width / 375) - size.height) > 0 ? 0 : ((667 * size.width / 375) - size.height);\n        this.width = size.width\n    },\n\n    touchStart(e) {\n        if (this.renwu.death) return;\n        this.yidongfig = true;\n\n        this.touchStart = e.getLocation();\n\n        this.caozuodi.stopAllActions();\n        this.caozuodi.opacity = 255;\n        this.caozuodi.y = this.touchStart.y - 667 + this.height\n        this.caozuodi.x = this.touchStart.x - 375\n    },\n    touchMove(e) {\n        if (this.renwu.death || !this.gameStart) {\n            this.yidongfig = false;\n            return\n        };\n        const delta = e.getDelta();\n        const angle = this.angle = wxcur.getAngle(0, 0, this.caozuoopan.x + delta.x, this.caozuoopan.y + delta.y)\n        const hudu = angle * Math.PI / 180;\n        const xiebian = Math.pow(Math.pow(this.caozuoopan.x + delta.x, 2) + Math.pow(this.caozuoopan.y + delta.y, 2), 0.5);\n        const maxxiebian = Math.pow(Math.pow((191 / 2) * Math.sin(hudu), 2) + Math.pow((186 / 2) * Math.cos(hudu), 2), 0.5);\n\n        if (xiebian >= maxxiebian) {\n            this.caozuoopan.x = (191 / 2) * Math.sin(hudu);\n            this.caozuoopan.y = (186 / 2) * Math.cos(hudu);\n        } else {\n            this.caozuoopan.x += delta.x;\n            this.caozuoopan.y += delta.y;\n        }\n    },\n    touchEnd(e) {\n        this.yidongfig = false;\n\n        this.caozuoopan.y = 0;\n        this.caozuoopan.x = 0;\n        this.caozuodi.runAction(cc.fadeOut(0.5))\n    },\n    ydshijiao() {\n        this.camera.x = this.renwu.node.x;\n        this.camera.y = this.renwu.node.y;\n        if (this.yidongfig) {\n            interact._this.gaoguang.x = this.renwu.node.x;\n            interact._this.gaoguang.y = this.renwu.node.y;\n            this.renwu.yidong(this.angle);\n        } else {\n            this.renwu.node.yidongfig = false\n        }\n    },\n    yingcang(node) {\n        const size = cc.view.getFrameSize();\n        const v2 = game._this.camera.convertToNodeSpaceAR(cc.v2(node.x, node.y));\n        v2.x += size.width;\n        v2.y += size.height;\n\n        if (v2.x > (size.width + node.width / 2) || v2.x < (-size.width - node.width / 2) || v2.y < (-size.height - node.height / 2) || v2.y > (size.height + node.height / 2)) {\n            node.opacity = 0\n        } else {\n            node.opacity = 255\n        }\n    },\n    update() {\n        this.ydshijiao();\n    },\n});\n\n\nexports.game = game;"]}